<Window x:Class="FastDB.MainWindow" 
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
xmlns:tk="http://schemas.microsoft.com/wpf/2008/toolkit" 
xmlns:xcdg="http://schemas.xceed.com/wpf/xaml/datagrid" 
xmlns:local="clr-namespace:FastDB" 
xmlns:myResultViewControl="clr-namespace:FastDB.Control" 
Title="Para-RD" FontFamily="Calibri" FontSize="13" Height="350" Width="525" WindowStyle="SingleBorderWindow" Icon="/FastDB;component/Images/LogoColorNoText.jpeg" Closing="Window_Closing" Closed="Window_Closed">

    <Window.Resources>

        <ResourceDictionary Source="./theme/generic.xaml">
        </ResourceDictionary>

    </Window.Resources>
    <Window.CommandBindings>
        <CommandBinding Command="ApplicationCommands.New" Executed="MenuCmdExecuted" CanExecute="MenuCmdCanExecute"/>
        <CommandBinding Command="ApplicationCommands.Open" Executed="MenuCmdExecuted" CanExecute="MenuCmdCanExecute"/>
        <CommandBinding Command="ApplicationCommands.Save" Executed="MenuCmdExecuted" CanExecute="MenuCmdCanExecute"/>
        <CommandBinding Command="ApplicationCommands.Close" Executed="MenuCmdExecuted" CanExecute="MenuCmdCanExecute"/>
    </Window.CommandBindings>



    <Grid x:Name="MainGrid">

        <DockPanel Name="DockPaenlMain" Background="White">
            <!-- this is left side panel-->
            <StackPanel Name="MainMenuStackPanel" Orientation="Vertical" DockPanel.Dock="Top" Margin="1,0" Height="25" >
                <Border BorderBrush="LightBlue">
                    <DockPanel>
                        <DockPanel.Background>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <LinearGradientBrush.GradientStops>
                                    <GradientStop Offset="0" Color="#FFFFFFFF" />
                                    <GradientStop Offset="1" Color="#DDEEF4" />
                                </LinearGradientBrush.GradientStops>
                            </LinearGradientBrush>
                        </DockPanel.Background>
                        <StackPanel>
                            <StackPanel.Background>
                                <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                    <LinearGradientBrush.GradientStops>
                                        <GradientStop Offset="0" Color="#FFFFFFFF" />
                                        <GradientStop Offset="1" Color="#DDEEF4" />
                                    </LinearGradientBrush.GradientStops>
                                </LinearGradientBrush>
                            </StackPanel.Background>
                            <Menu Name="MainMenu" DockPanel.Dock="Top" HorizontalAlignment="Left" IsMainMenu="True" Height="25px">
                                <Menu.Background>
                                    <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                        <LinearGradientBrush.GradientStops>
                                            <GradientStop Offset="0" Color="#FFFFFFFF" />
                                            <GradientStop Offset="1" Color="#DDEEF4" />
                                            <!--<GradientStop Offset="0.5" Color="#FFFFFFFF" />
                                            <GradientStop Offset="0.5" Color="#FFFFFFFF" />-->
                                            
                                            
                                        </LinearGradientBrush.GradientStops>
                                    </LinearGradientBrush>
                                </Menu.Background>
                                <MenuItem Header="F_ile" FontFamily="Calibri" FontSize="14.667" FontWeight="Normal" Cursor="Arrow" Focusable="True">                                   <!--Background="{StaticResource NormalBrush}"-->
                                    <MenuItem Name="menuItemNew"   Header="_New" FontFamily="Calibri" FontWeight="Normal" Command="ApplicationCommands.New" InputGestureText="Ctrl+N">
                                        <MenuItem.Icon>
                                            <Image Source="/FastDB;component/Images/NewDocumentHS.png" Width="16" Height="16"/>
                                        </MenuItem.Icon>
                                    </MenuItem>
                                    <MenuItem Name="menuItemOpen"   Header="_Open" FontFamily="Calibri" Command="ApplicationCommands.Open" InputGestureText="Ctrl+O">
                                        <MenuItem.Icon>
                                            <Image Source="/FastDB;component/Images/OpenHS.png" Width="16" Height="16"/>
                                        </MenuItem.Icon>
                                    </MenuItem>
                                    <MenuItem Name="menuItemSave"   Header="_Save" FontWeight="Normal" FontFamily="Calibri" Command="ApplicationCommands.Save"  InputGestureText="Ctrl+S">
                                        <MenuItem.Icon>
                                            <Image Source="/FastDB;component/Images/saveHS.png"  Width="16" Height="16"/>
                                        </MenuItem.Icon>
                                    </MenuItem>
                                    <MenuItem Name="menuItemSaveAs"   Header="_Save As" FontWeight="Normal" FontFamily="Calibri" Click="menuItemSaveAs_Click">
                                       
                                    </MenuItem>
                                    <MenuItem Name="menuItemImportScript"   Header="_Import Script" FontFamily="Calibri" Click="menuItemImportScript_Click">

                                    </MenuItem>
                                    <MenuItem Name="menuItemExit"   Header="_Exit" FontFamily="Calibri" Command="ApplicationCommands.Close">

                                    </MenuItem>
                                </MenuItem>
                               
                                <MenuItem Header="E_xport" FontFamily="Calibri" FontSize="14.667" FontWeight="Normal">
                                    <MenuItem Name="menuItemExportToPDF"   Header="E_xport To PDF" Click="menuItemExportToPDF_Click" FontWeight="Normal" FontFamily="Calibri"/>
                                    <MenuItem Name="menuItemExportToExcel"   Header="E_xport To Excel" Click="menuItemExportToExcel_Click" FontWeight="Normal" FontFamily="Calibri">
                                        <MenuItem.Icon>
                                            <Image Source="/Images/Excel-icon.png"></Image>
                                        </MenuItem.Icon>
                                    </MenuItem>
                                </MenuItem>
                                <MenuItem Header="H_elp" FontFamily="Calibri" FontSize="14.667" FontWeight="Normal" Focusable="True" >
                                    <MenuItem Name="menuItemViewHelp"   Header="_View Help" FontFamily="Calibri" FontWeight="Normal">
                                        <MenuItem.Icon>
                                            <Image Source="/FastDB;component/Images/Help.png" Width="16" Height="16"/>
                                        </MenuItem.Icon>
                                    </MenuItem>
                                    <MenuItem Name="menuItemAbout"   Header="_About" FontFamily="Calibri" FontWeight="Normal" Click="menuItemAbout_Click" />
                                </MenuItem>
                            </Menu>
                        </StackPanel>
                        <!--*****Hide custom query******-->


                    </DockPanel>
                </Border>
            </StackPanel>
            <DockPanel Name="MainTreeViewDocPanel" Margin="0,0" DockPanel.Dock="Left" HorizontalAlignment="Stretch">

                <StackPanel Name="TreeViewHideStackPanel" Width="0" Orientation="Vertical">

                    <!--<Button Name="BtnHideTreView" Width="18" VerticalContentAlignment="Stretch"  HorizontalAlignment="Center" Click="BtnHideTreView_Click" ToolTip="View Databases and Tables" Cursor="Hand" Height="22" RenderTransformOrigin="0.5,0.5">                                                
                    	
                        <Path Fill="#3366FF" Data="M 0,0 6,6 6,0 12,6 6,12 6,6 0,12 Z"/>
                    </Button>-->
                    <Button Name="BtnHideTreView" Width="20px" Click="BtnHideTreView_Click" HorizontalContentAlignment="Left"   VerticalContentAlignment="Center" ToolTip="View Databases and Tables" Cursor="Hand" Height="180">
                        <!--<TextBlock Height="100" Width="100" FontWeight="Bold" VerticalAlignment="Center" TextWrapping="Wrap" Text="D a t a  E x p l o r e r" ></TextBlock>-->
                        <!--<Label Name="lblHideTreView" Content="D a t a  E x p l o r e r"  Height="100" FontWeight="Bold"></Label>-->
                        <TextBlock Text="D a t a    E x p l o r e r" FontFamily="Verdana" TextAlignment="Justify" FontSize="11"  Width="10" TextWrapping="WrapWithOverflow"/>
                    </Button>


                </StackPanel>
                <DockPanel Name="TreeViewDocPanel" Width="199" Margin="1,0">

                    <StackPanel DockPanel.Dock="top" Background="{StaticResource NormalBrush}" >
                        <DockPanel Height="26">
                            <DockPanel.Background>
                                <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                    <LinearGradientBrush.GradientStops>
                                        <GradientStop Offset="0" Color="#FFFFFFFF" />
                                        <GradientStop Offset="1" Color="#DDEEF4" />
                                        
                                        <!--<GradientStop Offset="0.5" Color="#FFFFFFFF" />
                                        <GradientStop Offset="1" Color="#DDEEF4" />-->
                                    </LinearGradientBrush.GradientStops>
                                </LinearGradientBrush>
                            </DockPanel.Background>
                            <Border DockPanel.Dock="Top" BorderBrush="LightBlue" BorderThickness="1 1 1 0">
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Stretch" Height="20">
                                    <Label Content="Data Explorer" FontFamily="Calibri" FontSize="14.667" HorizontalAlignment="Left">
                                        <Label.RenderTransform>
                                            <TransformGroup>
                                                <TranslateTransform X="5" Y="0"/>
                                            </TransformGroup>
                                        </Label.RenderTransform>
                                    </Label>
                                    <Button x:Name="BtnPin" Width="20" Height="20" Margin="70,0,0,2" Background="White" Cursor="Hand" 
                                            Click="BtnPin_Click"  ToolTip="Hide Databases and Tables" HorizontalAlignment="Right">
                                        <Button.RenderTransform>
                                            <TransformGroup>
                                                <TranslateTransform X="20" Y="0"/>
                                            </TransformGroup>
                                        </Button.RenderTransform>
                                        <Button.Template>

                                            <ControlTemplate TargetType="{x:Type Button}">

                                                <Grid>
                                                    <Image Name="Normal" Source="/FastDB;component/Images/pin_black.png" Width="16" Height="16"/>
                                                </Grid>

                                            </ControlTemplate>

                                        </Button.Template>

                                    </Button>
                                </StackPanel>
                            </Border>
                        </DockPanel>
                    </StackPanel>

                    <Border Name="TreeViewMask" Padding="2" BorderBrush="LightBlue"  BorderThickness="1">
                        <TreeView Name="MainTreeView" ItemsSource="{Binding schemas}" FontFamily="Calibri" FontSize="14.667" FontWeight="Normal" Margin="2,0,0,0" Width="196" HorizontalAlignment="Left" SelectedItemChanged="MainTreeView_SelectedItemChanged" Style="{DynamicResource TreeViewStyle}">                            
                            <TreeView.BorderBrush>
                                <LinearGradientBrush>
                                    <GradientStop Color="White" Offset="0.0" />
                                    <GradientStop Color="#DDEEF4" Offset="0.5" />
                                    <GradientStop Color="#DDEEF4" Offset="1.0" />
                                </LinearGradientBrush>
                            </TreeView.BorderBrush>
                            <TreeView.Background>
                                <LinearGradientBrush>
                                    <GradientStop Color="White" Offset="0.0" />
                                    <GradientStop Color="#DDEEF4" Offset="0.5" />
                                    <GradientStop Color="#DDEEF4" Offset="1.0" />
                                </LinearGradientBrush>
                            </TreeView.Background>
                            <TreeView.ItemContainerStyle >

                                <Style TargetType="{x:Type TreeViewItem}">

                                    <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}" />

                                    <Setter Property="IsSelected" Value="{Binding IsSelected, Mode=TwoWay}" />

                                    <Setter Property="FontWeight" Value="Normal" />
                                    <Style.Triggers>

                                        <Trigger Property="IsSelected" Value="True">

                                            <Setter Property="FontWeight" Value="Normal" />
                                            <Setter Property="FontFamily" Value="Calibri"/>
                                            <Setter Property="FontSize" Value="14.667"/>

                                        </Trigger>

                                    </Style.Triggers>

                                </Style>

                            </TreeView.ItemContainerStyle>

                            <TreeView.Resources>

                                <HierarchicalDataTemplate DataType="{x:Type local:schemaViewModel}" ItemsSource="{Binding Children}">

                                    <StackPanel Orientation="Horizontal">
                                        <Image Width="16" Height="16" Margin="3,0" Source="Images\DatabaseNew.png" />
                                        <TextBlock Text="{Binding schemaName}" />

                                    </StackPanel>

                                </HierarchicalDataTemplate>
                                <HierarchicalDataTemplate DataType="{x:Type local:tableViewModel}">

                                    <StackPanel Orientation="Horizontal">
                                        <Image Width="16" Height="16" Margin="3,0" Source="Images\database_table.png" />
                                        <TextBlock Text="{Binding tableName}"/>

                                    </StackPanel>

                                </HierarchicalDataTemplate>
                            </TreeView.Resources>

                        </TreeView>
                    </Border>

                </DockPanel>


            </DockPanel>

            <myResultViewControl:AdornedControl x:Name="adornedControl" IsAdornerVisible="False" Margin="0,0">

                <myResultViewControl:AdornedControl.AdornerContent>

                    <DockPanel x:Name="DocPanelCustomQuery" Height="auto" Width="auto" Background="{StaticResource NormalBrush}" DockPanel.Dock="Right">
                  
                        <Border BorderThickness="1" BorderBrush="LightBlue" Padding="1">

                            <Grid SnapsToDevicePixels="True">

                                <DockPanel>

                                    <StackPanel Height="22" VerticalAlignment="Top" Background="{StaticResource NormalBrush}">
                                        <Border BorderBrush="LightBlue" BorderThickness="1" >
                                            <DockPanel >
                                                <TextBlock Name="CustomQueryTxTBlk" Height="25px" Background="{StaticResource NormalBrush}" Text="From" HorizontalAlignment="Left" Foreground="Black"/>
                                                <DockPanel DockPanel.Dock="Right" HorizontalAlignment="Right">

                                                    <Button x:Name="reSizeButton" Width="20" Height="20" Cursor="Hand" Click="reSizeButton_Click" Margin="0,0,0,0">

                                                        <Button.Template>

                                                            <ControlTemplate TargetType="{x:Type Button}">

                                                                <Grid>

                                                                    <Rectangle x:Name="Border" Fill="{DynamicResource ControlBackgroundBrush}" SnapsToDevicePixels="True"/>

                                                                    <Path Stretch="Fill" Stroke="Black" StrokeThickness="1" Margin="4.5" >

                                                                        <Path.Data>

                                                                            <RectangleGeometry Rect="26,26,13,13"/>

                                                                        </Path.Data>

                                                                    </Path>

                                                                    <Path Stretch="Fill" Stroke="Black" StrokeThickness="1" Margin="1.5" >

                                                                        <Path.Data>

                                                                            <RectangleGeometry Rect="6,6,3,3"/>

                                                                        </Path.Data>

                                                                    </Path>

                                                                </Grid>

                                                            </ControlTemplate>

                                                        </Button.Template>

                                                    </Button>
                                                    <Button x:Name="BtnPinCustomQueryWindow" Width="20" Height="20" Background="White" Cursor="Hand" Click="BtnPinCustomQueryWindow_Click"  ToolTip="Hide Custom Query Window">

                                                        <Button.Template>

                                                            <ControlTemplate TargetType="{x:Type Button}">

                                                                <Grid>
                                                                    <Image Name="Normal" Source="/FastDB;component/Images/pin.png" Width="20" Height="20"/>

                                                                </Grid>

                                                            </ControlTemplate>

                                                        </Button.Template>

                                                    </Button>
                                                </DockPanel>
                                            </DockPanel>
                                        </Border>
                                    </StackPanel>

                                </DockPanel>

                                <DockPanel Name="DockCustomQueryWindow" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Height="auto" Width="auto">
                                    <TabControl Name ="tabControlCustomQuery"  Width="auto" Height="auto" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" TabStripPlacement="Top" Style="{DynamicResource TabControlStyle}" Margin="0,17,0,0" SelectionChanged="tabControlCustomQuery_SelectionChanged" IsSynchronizedWithCurrentItem="true" >
                                        <TabItem x:Name="FromTabItem" Header="From" IsSelected="True" Foreground="Black" Margin="0,0,0,0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" >
                                            <myResultViewControl:FromTabControl x:Name="FromTabUC" DockPanel.Dock="Top"  Margin="0,0,0,0"  HorizontalAlignment="Stretch"   BorderBrush="LightBlue" BorderThickness="1" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch"/>
                                        </TabItem>
                                            <TabItem x:Name="WhereTabItem" Header="Where"  Foreground="Black" Margin="0,0,0,0"  >
                                            <myResultViewControl:WhereTabControl x:Name="WhereTabUC" DockPanel.Dock="Top"  Margin="0,0"  Height="auto" Width="auto" Background="{DynamicResource ControlBackgroundBrush}"   HorizontalAlignment="Stretch"   BorderBrush="LightBlue" BorderThickness="1" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch"/>
                                        </TabItem>
                                        <TabItem x:Name="SelectTabItem" Header="Select"  Foreground="Black" Background="{DynamicResource ControlBackgroundBrush}" Cursor="Hand" >
                                            <myResultViewControl:SelectTabControl x:Name="SelectTabUC" DockPanel.Dock="Top"  Margin="0,0"  Height="auto" Width="auto"   HorizontalAlignment="Stretch"  Background="{DynamicResource BlueBackGround}"  BorderBrush="LightBlue" BorderThickness="1" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch"/>
                                        </TabItem>
                                        <TabItem x:Name="TabulationTabItem" Header="Tabulation" Foreground="Black" Margin="0,0,0,0" Cursor="Hand"  VerticalAlignment="Stretch" HorizontalAlignment="Stretch" >
                                            <myResultViewControl:TabulationTabControl x:Name="TabulationTabUC" DockPanel.Dock="Top"  Margin="0,0"  Height="auto" Width="auto"  HorizontalAlignment="Stretch"   BorderBrush="LightBlue" BorderThickness="1" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch"/>
                                        </TabItem>
                                        <TabItem x:Name="CrossTabulationTabItem" Header="Cross Tabulation" Foreground="Black" Margin="0,0,0,0" Cursor="Hand">
                                            <myResultViewControl:CrossTabulationTabControl x:Name="CrossTabulationTabUC" DockPanel.Dock="Top"  Margin="0,0"  Height="auto" Width="auto"  HorizontalAlignment="Stretch"   BorderBrush="LightBlue" BorderThickness="1" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch"/>
                                        </TabItem>
                                        <TabItem x:Name="ActionsTabItem" Header="Query"  Foreground="Black" Margin="0,0,0,0"  Height="auto" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" >
                                            <DockPanel Margin="0,0,0,0" Width="auto" Height="auto" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="{DynamicResource ControlBackgroundBrush}">
                                                <Label Name="lblActionTabErrorMessage" DockPanel.Dock="Top" Content="" HorizontalAlignment="Center"  Height="20" FontWeight="Normal" Foreground="Red" Background="Black" Visibility="Visible" />
                                                <DockPanel Height="620" VerticalAlignment="Top">
                                                    <TextBox Name="txtQuery"    Height="580"    AcceptsReturn="True" VerticalScrollBarVisibility="Auto" DockPanel.Dock="Top" HorizontalAlignment="Stretch"  Margin="0,0,0,0"  MaxWidth="1200"/>
                                                    <Button Name="btnRunQuery" Height="20" Width="80" Content="Run Query" Margin="0,10" Click="btnRunQuery_Click" DockPanel.Dock="Top" />
                                                </DockPanel>
                                            </DockPanel>
                                        </TabItem>
                                    </TabControl>
                                </DockPanel>
                            </Grid>
                        </Border>
                    </DockPanel>
                </myResultViewControl:AdornedControl.AdornerContent>

                <!-- the middle section datagrid-->

                <DockPanel DockPanel.Dock="Right">
                    <!--moved main menu from here-->
                    <DockPanel DockPanel.Dock="Top">                        
                            <TabControl Name ="tabControl1" Height="Auto" FontFamily="Calibri" FontWeight="Normal" 
                                        VerticalAlignment="Top" Width="auto" HorizontalAlignment="Stretch" TabStripPlacement="Top" 
                                        Style="{DynamicResource TabControlStyle}" Visibility="Hidden" 
                                        SelectionChanged="tabControl1_SelectionChanged">
                            </TabControl>
                            <Image Name="Logo" Source="/FastDB;component/Images/NoemaSystemsLogo.png" Width="700" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" DockPanel.Dock="Top" Margin="0,100"/>
                            <Label Name="LogoTxt" Content=" Copyright© Noema Systems Inc 2011 " Margin="0,10" DockPanel.Dock="Bottom" HorizontalAlignment="Center"/>                                                                            
                    </DockPanel>
                </DockPanel>

            </myResultViewControl:AdornedControl>
        </DockPanel>
    </Grid>
</Window> 
 
